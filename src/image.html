<!doctype html>
<html>
  <head>
    <link rel="stylesheet" href="common.css" />
    <link rel="stylesheet" href="image.css" />
    <title>Danbooru Tools - Image Tools</title>

    <!-- v5 -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@upscalerjs/esrgan-thick@latest/dist/umd/4x.min.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/@upscalerjs/maxim-deblurring@latest/dist/umd/models/maxim-deblurring/src/umd.min.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/upscaler@latest/dist/browser/umd/upscaler.min.js"></script>
    <script src="scripts/image.js" type="module" defer></script>
    <script src="scripts/load-settings.js"></script>
  </head>
  <body>
    <header>
      <a href="index.html">Home</a>
      <a href="commentary.html">Commentary Tools</a>
      <a href="image.html" id="current-page">Image Tools</a>
      <a href="settings.html">Settings</a>
    </header>

    <h1 style="margin-top: 0">Image Tools</h1>
    <div class="top-bar">
      <label for="lang">OCR Language:</label>
      <select id="lang" name="ocr.lang" class="setting">
        <option value="jpn">Japanese</option>
        <option value="chi_sim">Chinese - Simplified</option>
        <option value="chi_tra">Chinese - Traditional</option>
        <option value="eng">English</option>
      </select>
      <label for="dir">Textbox direction:</label>
      <select id="dir" name="ocr.dir" class="setting">
        <option value="ltr">Left-to-right</option>
        <option value="rtl">Right-to-left</option>
        <option value="ttb">Top-to-bottom</option>
      </select>
      <button id="rerun-btn">Rerun OCR</button>
      <input
        type="checkbox"
        name="ocr.autorun"
        id="autorun"
        class="setting"
        checked
      />
      <label for="autorun">Autorun OCR on image load</label>
    </div>
    <div class="top-bar">
      <label for="confidence">Confidence threshold:</label>
      <input
        type="range"
        min="0"
        max="100"
        value="90"
        id="confidence"
        name="ocr.confidence"
        class="setting"
      />
      <span id="slider-readout">90%</span>
    </div>
    <div class="top-bar">
      <button id="clear-boxes-btn">Clear boxes</button>
      <button id="clear-img-btn">Clear image</button>
      <button id="upscale-btn">Upscale image</button>

      <i>
        Press
        <span style="color: blue">
          "N" to draw boxes around areas of interest
        </span>
        or <span style="color: green">"C" to combine nearby boxes</span>.
      </i>
    </div>

    <div id="main">
      <div id="image-container">
        <div id="no-image">
          <p style="text-align: center">
            Paste or drag an image here to begin.
          </p>
          <div id="button-grid">
            <button id="paste-btn">
              <img src="assets/clipboard.svg" alt="clipboard" />Paste from
              clipboard
            </button>
            <button id="link-btn">
              <img src="assets/link.svg" alt="link" />Enter link...
            </button>
            <button id="file-btn">
              <img src="assets/file.svg" alt="file" />Select file...
            </button>
          </div>
        </div>
        <div id="with-image" style="display: none">
          <p id="image-text" style="display: none">Test text</p>
          <img src="" id="preview" />
        </div>
      </div>
      <div id="textbox-container">
        <h4>Original</h4>
        <textarea id="original"></textarea>
        <h4>DeepL'd</h4>
        <textarea id="deepl" readonly></textarea>
        <button id="retranslate-btn">Retranslate</button>
      </div>
    </div>
  </body>
</html>
