<!doctype html>
<html>
  <head>
    <link rel="stylesheet" href="common.css" />
    <title>Danbooru Tools - Image Tools</title>

    <!-- v5 -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="scripts/image.js" type="module" defer></script>
    <script src="scripts/load-settings.js"></script>
    <style>
      body {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .top-bar {
        display: flex;
        gap: 6px;
        align-items: center;
      }
      #main {
        flex: 1;
        display: flex;
        align-items: stretch;
        gap: 12px;
      }

      #image-container {
        flex: 2;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 6px;
      }
      #textbox-container {
        position: sticky;
        top: calc(2em + 6px);
        max-height: calc(100vh - 8.87em - 62px);

        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: stretch;
      }
      #textbox-container > textarea {
        flex: 1;
      }

      #with-image {
        position: relative;
      }
      #with-image > img {
        margin-bottom: -6px;
        max-width: 100%;
      }
      .bbox {
        background: #0004;
        border: 1px solid white;
        position: absolute;
        cursor: pointer;
      }

      #no-image {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      #button-grid {
        display: grid;
        grid: 1fr 1fr / 1fr 1fr;
        gap: 6px;
      }
      #button-grid > button {
        display: flex;
        /* justify-content: space-between; */
        align-items: center;
        gap: 6px;
        padding-left: 6px;
        padding-right: 12px;
      }
      #button-grid > button > img {
        width: 1lh;
        height: 1lh;
      }
    </style>
  </head>
  <body>
    <header>
      <a href="index.html">Home</a>
      <a href="commentary.html">Commentary Tools</a>
      <a href="image.html" id="current-page">Image Tools</a>
      <a href="settings.html">Settings</a>
    </header>

    <h1 style="margin-top: 0">Image Tools</h1>
    <div class="top-bar">
      <label for="lang">OCR Language:</label>
      <select id="lang" name="ocr.lang" class="setting">
        <option value="jpn">Japanese</option>
        <option value="chi_sim">Chinese - Simplified</option>
        <option value="chi_tra">Chinese - Traditional</option>
        <option value="eng">English</option>
      </select>
      <button id="rerun-btn">Rerun OCR</button>
    </div>
    <div class="top-bar">
      <label for="confidence">Confidence threshold:</label>
      <input
        type="range"
        min="0"
        max="100"
        value="50"
        id="confidence"
        name="ocr.confidence"
        class="setting"
      />
      <span id="slider-readout">50%</span>
    </div>
    <div class="top-bar">
      <button id="clear-boxes-btn">Clear boxes</button>
      <button id="clear-img-btn">Clear image</button>

      <i style="color: blue">
        Press "N" to draw boxes around areas of interest.
      </i>
    </div>

    <div id="main">
      <div id="image-container">
        <div id="no-image">
          <p>Paste or drag an image here to begin.</p>
          <div id="button-grid">
            <button id="paste-btn">
              <img src="assets/clipboard.svg" alt="clipboard" />Paste from
              clipboard
            </button>
            <button id="link-btn">
              <img src="assets/link.svg" alt="link" />Enter link...
            </button>
            <button id="file-btn">
              <img src="assets/file.svg" alt="file" />Select file...
            </button>
          </div>
        </div>
        <div id="with-image" style="display: none">
          <img src="" id="preview" />
        </div>
      </div>
      <div id="textbox-container">
        <h4>Original</h4>
        <textarea id="original"></textarea>
        <h4>DeepL'd</h4>
        <textarea id="deepl" readonly></textarea>
        <button id="retranslate-btn">Retranslate</button>
      </div>
    </div>
  </body>
</html>
